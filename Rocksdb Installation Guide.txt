//Procedure to install and test Rocksdb

// Assuming to start with a new server without any installed package
//1) Install the environment

apt-get update
apt-get install g++ gcc make cmake
apt-get install libgflags-dev libsnappy-dev zlib1g-dev libbz2-dev
apt-get install liblz4-dev libzstd-dev

//2) Clone the files from rocksdb (version used: 7.7.3) and make installation

//give permission
chmod 775 rocksdb-7.7.3/build_tools/build_detect_platform
chmod 775 rocksdb-7.7.3/build_tools/version.sh

//Changing windows line endings
sudo apt-get install -y dos2unix
sudo find . -type f -exec dos2unix {} \;

//static lib to get librocksdb.a
make static_lib
//to avoid error for complie with -fPIC
make clean

//dynamic lib to get librocksdb.so
make shared_lib

//3) Copy files to system lib
cp librocksdb.so.7.7.3 /usr/local/lib
ln -s librocksdb.so.7.7.3 /usr/local/lib/librocksdb.so
ln -s librocksdb.so.7.7.3 /usr/local/lib/librocksdb.so.7
ln -s librocksdb.so.7.7.3 /usr/local/lib/librocksdb.so.7.7

//4) Environmental path
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local/lib
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local/lib:/home/shijc/rocksdb-7.7.3

//5) Create and compile test.cpp file
// Put rocksdbtest.cpp under ./rocksdb-7.7.3
g++ -std=c++17 -o rocksdbtest2 rocksdbtest.cpp -I /home/shijc/rocksdb-7.7.3/include -L /home/shijc/rocksdb-7.7.3 -lrocksdb -ldl
./rocksdbtest2